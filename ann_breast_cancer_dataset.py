# -*- coding: utf-8 -*-
"""ANN BREAST CANCER DATASET.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Pd4pkwn1yUps7aAkGOQwifqa_aOXOb13
"""

#import all necessary library
import numpy as np
import pandas as pd
from sklearn.datasets import load_breast_cancer
import keras
from keras.models import Sequential
from keras.layers import Dense

#load data and seperate Dependent and Independent 
data=load_breast_cancer()
X=data.data
Y=data.target

#explore the data
print(X)

#explore the target
print(Y)

#what is to be classify
print(data.target_names)
#the objective is to predict the type of cancer using ANN/MLP
#class to predict is :['malignant' 'benign']

#we will split data for training stage and testing stage as we ANN comes under Supervised Stage
from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(X,Y,test_size=.30,random_state=42)

#lets start forming our ANN model With 1 Hidden Layer
#make model from keras
model=Sequential()

#first Hidden Layer
model.add(Dense(16,kernel_initializer='glorot_uniform',activation='relu',input_dim=30))
#hidden layer nodes input/2 number

#2nd hidden layer
model.add(Dense(16,kernel_initializer='glorot_uniform',activation='relu'))

#Output Layer
model.add(Dense(1,kernel_initializer='glorot_uniform',activation='sigmoid'))

#model compile
model.compile(optimizer='Adam',loss='binary_crossentropy',metrics=['accuracy'])

#model train on training Datasets
model.fit(x_train,y_train,batch_size=100,epochs=150)
'''
Epoch 1/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1541 - accuracy: 0.9296
Epoch 2/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1538 - accuracy: 0.9347
Epoch 3/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1535 - accuracy: 0.9347
Epoch 4/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1586 - accuracy: 0.9296
Epoch 5/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1710 - accuracy: 0.9246
Epoch 6/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1613 - accuracy: 0.9271
Epoch 7/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1570 - accuracy: 0.9397
Epoch 8/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1530 - accuracy: 0.9322
Epoch 9/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1518 - accuracy: 0.9322
Epoch 10/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1539 - accuracy: 0.9296
Epoch 11/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1512 - accuracy: 0.9397
Epoch 12/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1521 - accuracy: 0.9372
Epoch 13/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1535 - accuracy: 0.9271
Epoch 14/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1520 - accuracy: 0.9347
Epoch 15/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1500 - accuracy: 0.9372
Epoch 16/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1551 - accuracy: 0.9296
Epoch 17/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1614 - accuracy: 0.9221
Epoch 18/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1489 - accuracy: 0.9347
Epoch 19/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1545 - accuracy: 0.9372
Epoch 20/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1523 - accuracy: 0.9372
Epoch 21/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1751 - accuracy: 0.9246
Epoch 22/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1816 - accuracy: 0.9146
Epoch 23/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1666 - accuracy: 0.9296
Epoch 24/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1562 - accuracy: 0.9397
Epoch 25/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1497 - accuracy: 0.9296
Epoch 26/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1529 - accuracy: 0.9322
Epoch 27/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1628 - accuracy: 0.9322
Epoch 28/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1565 - accuracy: 0.9296
Epoch 29/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1492 - accuracy: 0.9347
Epoch 30/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1470 - accuracy: 0.9372
Epoch 31/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1560 - accuracy: 0.9347
Epoch 32/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1528 - accuracy: 0.9322
Epoch 33/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1561 - accuracy: 0.9322
Epoch 34/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1792 - accuracy: 0.9221
Epoch 35/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1624 - accuracy: 0.9397
Epoch 36/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1712 - accuracy: 0.9271
Epoch 37/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1651 - accuracy: 0.9246
Epoch 38/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1579 - accuracy: 0.9372
Epoch 39/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1549 - accuracy: 0.9271
Epoch 40/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1485 - accuracy: 0.9322
Epoch 41/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1519 - accuracy: 0.9347
Epoch 42/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1472 - accuracy: 0.9347
Epoch 43/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1490 - accuracy: 0.9322
Epoch 44/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1478 - accuracy: 0.9397
Epoch 45/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1557 - accuracy: 0.9372
Epoch 46/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1565 - accuracy: 0.9296
Epoch 47/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1660 - accuracy: 0.9246
Epoch 48/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1499 - accuracy: 0.9322
Epoch 49/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1503 - accuracy: 0.9322
Epoch 50/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1505 - accuracy: 0.9322
Epoch 51/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1534 - accuracy: 0.9271
Epoch 52/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1454 - accuracy: 0.9422
Epoch 53/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1437 - accuracy: 0.9322
Epoch 54/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1435 - accuracy: 0.9347
Epoch 55/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1428 - accuracy: 0.9372
Epoch 56/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1461 - accuracy: 0.9322
Epoch 57/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1458 - accuracy: 0.9447
Epoch 58/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1450 - accuracy: 0.9372
Epoch 59/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1454 - accuracy: 0.9347
Epoch 60/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1457 - accuracy: 0.9296
Epoch 61/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1438 - accuracy: 0.9422
Epoch 62/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1451 - accuracy: 0.9296
Epoch 63/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1448 - accuracy: 0.9347
Epoch 64/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1426 - accuracy: 0.9397
Epoch 65/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1417 - accuracy: 0.9347
Epoch 66/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1520 - accuracy: 0.9296
Epoch 67/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1498 - accuracy: 0.9322
Epoch 68/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1492 - accuracy: 0.9372
Epoch 69/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1397 - accuracy: 0.9397
Epoch 70/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1408 - accuracy: 0.9422
Epoch 71/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1392 - accuracy: 0.9372
Epoch 72/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1398 - accuracy: 0.9322
Epoch 73/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1415 - accuracy: 0.9397
Epoch 74/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1409 - accuracy: 0.9397
Epoch 75/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1428 - accuracy: 0.9372
Epoch 76/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1469 - accuracy: 0.9397
Epoch 77/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1443 - accuracy: 0.9347
Epoch 78/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1397 - accuracy: 0.9372
Epoch 79/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1420 - accuracy: 0.9347
Epoch 80/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1400 - accuracy: 0.9372
Epoch 81/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1411 - accuracy: 0.9347
Epoch 82/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1373 - accuracy: 0.9447
Epoch 83/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1390 - accuracy: 0.9422
Epoch 84/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1445 - accuracy: 0.9447
Epoch 85/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1424 - accuracy: 0.9322
Epoch 86/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1384 - accuracy: 0.9372
Epoch 87/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1412 - accuracy: 0.9397
Epoch 88/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1594 - accuracy: 0.9246
Epoch 89/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1369 - accuracy: 0.9447
Epoch 90/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1429 - accuracy: 0.9347
Epoch 91/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1456 - accuracy: 0.9422
Epoch 92/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1392 - accuracy: 0.9347
Epoch 93/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1521 - accuracy: 0.9322
Epoch 94/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1428 - accuracy: 0.9397
Epoch 95/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1433 - accuracy: 0.9372
Epoch 96/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1498 - accuracy: 0.9497
Epoch 97/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1355 - accuracy: 0.9472
Epoch 98/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1364 - accuracy: 0.9422
Epoch 99/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1372 - accuracy: 0.9397
Epoch 100/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1366 - accuracy: 0.9372
Epoch 101/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1359 - accuracy: 0.9372
Epoch 102/150
4/4 [==============================] - 0s 4ms/step - loss: 0.1409 - accuracy: 0.9472
Epoch 103/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1417 - accuracy: 0.9397
Epoch 104/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1471 - accuracy: 0.9372
Epoch 105/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1403 - accuracy: 0.9447
Epoch 106/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1339 - accuracy: 0.9372
Epoch 107/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1348 - accuracy: 0.9447
Epoch 108/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1424 - accuracy: 0.9397
Epoch 109/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1452 - accuracy: 0.9397
Epoch 110/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1521 - accuracy: 0.9322
Epoch 111/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1500 - accuracy: 0.9347
Epoch 112/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1439 - accuracy: 0.9422
Epoch 113/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1567 - accuracy: 0.9347
Epoch 114/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1385 - accuracy: 0.9397
Epoch 115/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1338 - accuracy: 0.9447
Epoch 116/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1359 - accuracy: 0.9372
Epoch 117/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1354 - accuracy: 0.9447
Epoch 118/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1339 - accuracy: 0.9372
Epoch 119/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1319 - accuracy: 0.9422
Epoch 120/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1321 - accuracy: 0.9447
Epoch 121/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1330 - accuracy: 0.9447
Epoch 122/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1369 - accuracy: 0.9296
Epoch 123/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1361 - accuracy: 0.9422
Epoch 124/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1366 - accuracy: 0.9447
Epoch 125/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1305 - accuracy: 0.9472
Epoch 126/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1313 - accuracy: 0.9497
Epoch 127/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1346 - accuracy: 0.9422
Epoch 128/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1402 - accuracy: 0.9397
Epoch 129/150
4/4 [==============================] - 0s 3ms/step - loss: 0.1319 - accuracy: 0.9447
Epoch 130/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1310 - accuracy: 0.9372
Epoch 131/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1328 - accuracy: 0.9422
Epoch 132/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1366 - accuracy: 0.9422
Epoch 133/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1423 - accuracy: 0.9422
Epoch 134/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1528 - accuracy: 0.9372
Epoch 135/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1521 - accuracy: 0.9372
Epoch 136/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1404 - accuracy: 0.9422
Epoch 137/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1390 - accuracy: 0.9422
Epoch 138/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1352 - accuracy: 0.9447
Epoch 139/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1357 - accuracy: 0.9422
Epoch 140/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1354 - accuracy: 0.9422
Epoch 141/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1267 - accuracy: 0.9447
Epoch 142/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1279 - accuracy: 0.9523
Epoch 143/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1344 - accuracy: 0.9372
Epoch 144/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1398 - accuracy: 0.9322
Epoch 145/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1416 - accuracy: 0.9447
Epoch 146/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1441 - accuracy: 0.9322
Epoch 147/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1349 - accuracy: 0.9372
Epoch 148/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1274 - accuracy: 0.9447
Epoch 149/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1342 - accuracy: 0.9472
Epoch 150/150
4/4 [==============================] - 0s 2ms/step - loss: 0.1329 - accuracy: 0.9397

<tensorflow.python.keras.callbacks.History at 0x7fbcc800bcc0>
'''

#lets predict the test datasets
pred=model.predict(x_test)
#we will predict on x_test and compare with y_test for analysis
#lets generate a threshold value where acuuracy is maximum
#lets say if pred>0.5 its 1 else 0
prediction=[]
for i in pred:
   if(i>0.5):
     prediction.append(1)
   else:
     prediction.append(0)

from sklearn.metrics import accuracy_score
print("ANN Accuracy is :",accuracy_score(y_test,prediction))

#ANN Accuracy is : 0.9649122807017544











